<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>定時鎖時間計算器</title>
<style>
  body {
    font-family: Arial, sans-serif;
    font-size: 1.5rem;
    background-color: #fefefe;
    padding: 1rem;
    line-height: 2rem;
  }
  h1 {
    font-size: 2rem;
    text-align: center;
    margin-bottom: 1rem;
  }
  label, select, input {
    display: block;
    margin: 0.5rem 0;
    font-size: 1.5rem;
  }
  button {
    font-size: 1.6rem;
    padding: 0.8rem 1.2rem;
    margin: 1rem 0;
    width: 100%;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 8px;
  }
  button:hover {
    background-color: #45a049;
  }
  .result {
    margin-top: 1.5rem;
    padding: 1rem;
    background-color: #f0f0f0;
    border-radius: 8px;
    font-size: 1.6rem;
    text-align: center;
  }
</style>
</head>
<body>

<h1>定時鎖時間計算器</h1>

<label>選擇起始時間：</label>
<button onclick="useNow()">現在時間</button>
<button onclick="useCustom()">另外指定時間</button>

<div id="customStart" style="display:none; margin-top:1rem;">
  <label>起始時間（月/日/上午/下午/時/分）：</label>
  <select id="startMonth">
    <option value="">月</option>
<option value="1">1月</option>
<option value="2">2月</option>
<option value="3">3月</option>
<option value="4">4月</option>
<option value="5">5月</option>
<option value="6">6月</option>
<option value="7">7月</option>
<option value="8">8月</option>
<option value="9">9月</option>
<option value="10">10月</option>
<option value="11">11月</option>
<option value="12">12月</option>
  </select>
  <select id="startDay">
    <option value="">日</option>
<option value="1">1日</option>
<option value="2">2日</option>
<option value="3">3日</option>
<option value="4">4日</option>
<option value="5">5日</option>
<option value="6">6日</option>
<option value="7">7日</option>
<option value="8">8日</option>
<option value="9">9日</option>
<option value="10">10日</option>
<option value="11">11日</option>
<option value="12">12日</option>
<option value="13">13日</option>
<option value="14">14日</option>
<option value="15">15日</option>
<option value="16">16日</option>
<option value="17">17日</option>
<option value="18">18日</option>
<option value="19">19日</option>
<option value="20">20日</option>
<option value="21">21日</option>
<option value="22">22日</option>
<option value="23">23日</option>
<option value="24">24日</option>
<option value="25">25日</option>
<option value="26">26日</option>
<option value="27">27日</option>
<option value="28">28日</option>
<option value="29">29日</option>
<option value="30">30日</option>
<option value="31">31日</option>
  </select>
  <select id="startAmPm">
    <option value="AM">上午</option>
    <option value="PM">下午</option>
  </select>
  <input type="number" id="startHour" placeholder="時 (1-12)" min="1" max="12">
  <input type="number" id="startMinute" placeholder="分 (0-59)" min="0" max="59">
</div>

<div id="openTime" style="margin-top:1rem;">
  <label>開啟時間（月/日/上午/下午/時/分）：</label>
  <select id="openMonth">
    <option value="">月</option>
<option value="1">1月</option>
<option value="2">2月</option>
<option value="3">3月</option>
<option value="4">4月</option>
<option value="5">5月</option>
<option value="6">6月</option>
<option value="7">7月</option>
<option value="8">8月</option>
<option value="9">9月</option>
<option value="10">10月</option>
<option value="11">11月</option>
<option value="12">12月</option>
  </select>
  <select id="openDay">
    <option value="">日</option>
<option value="1">1日</option>
<option value="2">2日</option>
<option value="3">3日</option>
<option value="4">4日</option>
<option value="5">5日</option>
<option value="6">6日</option>
<option value="7">7日</option>
<option value="8">8日</option>
<option value="9">9日</option>
<option value="10">10日</option>
<option value="11">11日</option>
<option value="12">12日</option>
<option value="13">13日</option>
<option value="14">14日</option>
<option value="15">15日</option>
<option value="16">16日</option>
<option value="17">17日</option>
<option value="18">18日</option>
<option value="19">19日</option>
<option value="20">20日</option>
<option value="21">21日</option>
<option value="22">22日</option>
<option value="23">23日</option>
<option value="24">24日</option>
<option value="25">25日</option>
<option value="26">26日</option>
<option value="27">27日</option>
<option value="28">28日</option>
<option value="29">29日</option>
<option value="30">30日</option>
<option value="31">31日</option>
  </select>
  <select id="openAmPm">
    <option value="AM">上午</option>
    <option value="PM">下午</option>
  </select>
  <input type="number" id="openHour" placeholder="時 (1-12)" min="1" max="12">
  <input type="number" id="openMinute" placeholder="分 (0-59)" min="0" max="59">
</div>

<button onclick="calculateTime()">計算應撥定時間</button>

<div class="result" id="result"></div>

<script>
let startTime = null;

function useNow() {
  startTime = new Date();
  document.getElementById('customStart').style.display = 'none';
  alert(`已使用現在時間：${startTime.toLocaleString()}`);
}

function useCustom() {
  startTime = null;
  document.getElementById('customStart').style.display = 'block';
}

function calculateTime() {
  if (!startTime) {
    const month = parseInt(document.getElementById('startMonth').value);
    const day = parseInt(document.getElementById('startDay').value);
    let hour = parseInt(document.getElementById('startHour').value);
    const minute = parseInt(document.getElementById('startMinute').value);
    const ampm = document.getElementById('startAmPm').value;

    if(!month || !day || !hour || minute==null || isNaN(minute)){
      alert("請完整填寫起始時間！");
      return;
    }
    if(ampm === "PM" && hour !== 12) hour += 12;
    if(ampm === "AM" && hour === 12) hour = 0;

    const now = new Date();
    startTime = new Date(now.getFullYear(), month-1, day, hour, minute);
  }

  const monthO = parseInt(document.getElementById('openMonth').value);
  const dayO = parseInt(document.getElementById('openDay').value);
  let hourO = parseInt(document.getElementById('openHour').value);
  const minuteO = parseInt(document.getElementById('openMinute').value);
  const ampmO = document.getElementById('openAmPm').value;

  if(!monthO || !dayO || !hourO || minuteO==null || isNaN(minuteO)){
    alert("請完整填寫開啟時間！");
    return;
  }
  if(ampmO === "PM" && hourO !== 12) hourO += 12;
  if(ampmO === "AM" && hourO === 12) hourO = 0;

  const now = new Date();
  const openTime = new Date(now.getFullYear(), monthO-1, dayO, hourO, minuteO);

  let diff = openTime - startTime;
  if(diff < 0){
    document.getElementById('result').innerHTML = "開啟時間早於起始時間，請重新設定！";
    return;
  }

  const days = Math.floor(diff / (1000*60*60*24));
  diff -= days * 1000*60*60*24;
  const hours = Math.floor(diff / (1000*60*60));
  diff -= hours * 1000*60*60;
  const minutes = Math.floor(diff / (1000*60));

  document.getElementById('result').innerHTML = `
    應撥定時間：<br>
    ${days} 天 ${hours} 小時 ${minutes} 分鐘<br><br>
    請務必再三確認撥定時間，祝業績長紅
  `;
}
</script>

</body>
</html>
